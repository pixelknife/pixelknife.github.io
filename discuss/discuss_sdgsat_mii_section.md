# SDGSAT多光谱(MII)片间平衡处理

## 背景

SDGSAT的多光谱MII传感器存在一个固有的问题，波段各片之间存在时变的片间差异变化，主要表现为奇数片和偶数片之间的差异（一组是直接投射一组是通过镜面反射），这些是卫星上天以后无法改变的情况。

这个问题的实际影响是波段1的波动情况最大，波段2次之，波段3以后影响逐渐减少。在水体等均匀介质区域情况特别明显。

片间差异是对地物实际情况的一种显著的偏离，在没有其他参考的情况下，将片间差异校平或者减少偏差，这样的结果更接近实际情况。

## 修正

相邻两片，各取一定相邻区（宽度g），每行分别在左右两侧各取g个像素算中间值作为代表值，然后再将右边减左边的数值作这一行的片间差。这个g值理论上越小越好，但是由于多片成像的原理在两侧存在渐进区，这些像元非线性较强，可能有一个爬坡过度的区域，所以还是要更大宽度来容忍这样的过渡区域的影响。

地物始终是在变化的，这样的以行计算的片间差波动很大。需要再通过一个比较宽的范围内（s行）做移动取中值的方法来做纵向的平滑，将地物本身的变化平滑削弱，剩下的主要是片间缓慢变化的差异。

最后将上面统计出的片间差异用到修复原图像上。确定一个不变基准，假设直接投射的偶数片（2、4、6、8片）受影响情况较小，作为校正的实际基础，不用变动。第1片只考虑补偿右边第2片的差值，而第3、5、7片则同时考虑左边和右边相邻片的差异。



[![qTToA1.jpg](https://s1.ax1x.com/2022/04/03/qTToA1.jpg)](https://imgtu.com/i/qTToA1)

▲波段1的处理比较，上方是处理前的原图，下方是处理后的结果。


如果只是一次处理一景，因为32700的景高度相对1000行的平滑还不是非常长，因此在景开始和景结束的时候平均偏差应该是大于中间的的部分。如果能够将一整个轨道同时处理，那么纠正偏差更小，而且前后景镶嵌衔接没有缝隙。

原数据集存在各个波段因为波段间配准操作导致上下留空不一致的情况，这在未来构图分析的时候引入不少无意义的麻烦，这里在重新输出的时候，统一在上下都截取了500行填充0。这样各波段做波段组合的时候都是整齐划一的了。



---



陈甫 副研究员
中国科学院空天信息创新研究院
chenfu@aircas.ac.cn
13811147935